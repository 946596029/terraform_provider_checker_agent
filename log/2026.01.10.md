# 2026.01.10 开发日志

## 阶段五
### 目标 - 使用 langchain 框架实现 prompt 发送功能
  - 建立 langchain 文件夹
  - 引入 langchain 依赖
  - 使用 langchain 实现 prompt 与大模板对话
  - 使用 langchain 实现 prompt 模板与大模型对话
-----------------------------------------------------
### 步骤
  - [x] 引入 langchain 依赖
  - [x] 建立项目框架
  - [x] 把项目跑起来
  - [x] 实现一次大模型对话
  - [x] 了解不同角色的的用途，system，assistant, user
  - [x] 了解 prompt 提示词怎样编写最有效
  - [x] 注册一个 prompt 模板
  - [x] 实现 prompt 模板与大模型对话
  - [x] 设计代码检查的流程（以人为主）
-----------------------------------------------------
### 完成情况
  - 全部完成，开始流程实现，先实现最简单的流程
-----------------------------------------------------
### 问题
  - 在系统对话中 Role 的作用是什么？
    + Role 常用的有 system, user, assistant，也可以自行定义
    + Role 的作用
      * 告诉模型“这段话是谁说的”，从而决定生成策略
      * 把长对话切成可复用的“块”，方便工程上做缓存、截断、继续生成
      * 给用户或上层应用一个插拔式“接口”，通过换角色就能让同一大模型表现出不同行为，而无需重新训练
    + 各个角色的作用
      * System：隐形的“导演”
        - 设定世界观、安全边界、输出格式
        - 优先级最高，一旦与后面冲突，模型倾向听它的
      * Assistant：模型自己，也是“被优化对象”
        - 在训练阶段，assistant 消息里的 token 会被计算损失，模型参数据此更新
        - 在推理阶段，它其实就是“上一段自己的输出”，被当成历史再喂回上下文，形成多轮记忆
  - 开发流程
    + 搭建项目 -> 梳理业务流程 -> 确定节点 -> 设计 prompt
  - langchain 中会将 `{}` 识别为模板变量
    + 需要将 `{` 替换为 `{{`, `}` 替换为 `}}`
  - 在 python 代码中导出定义的变量
    + 变量所在文件
    + 所在文件夹 `__init__.py`
  - 代码检查的流程
    + user, 输入要检查的特性 $feat
    + system, 根据 $feat 搜索对应的文档位置
    + system 列出所有要检查的文档，等待 user 进行确认
    + terraform provider 代码检查子流程
      * 检查 implement 部分
        - 检查 implement 文件代码规范
        - 列出修改代码规范问题处，等待 user 确认
        - 根据修改后的结果 提取 provider schema 信息
      * 检查 document 部分
        - 检查 document 文件代码规范
        - schema 关联性信息检查
          - 询问二义性边界，确定修改范围
        - 根据修改后的结果 补充 provider schema 信息
      * 检查 test case 部分
        - 检查 test 文件代码规范
        - schema 关联性信息检查
          - 询问二义性边界，确定修改范围
        - 根据修改后的结果 补充 provider test case 信息
      * 列出修改代码规范问题处，等待 user 确认
